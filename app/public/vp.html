<p>
    <a class="vp-optin"></a>
</p>


<pre class="debug"></pre>


<script type="module">
    import { VisitorProgress } from './res/visitorprogress.js'

    const VP = new VisitorProgress()

    const vp_optin_toggle = document.querySelector('.vp-optin')
    const debug_output = document.querySelector('.debug')
    const update_display = (clear) => {
        if (clear === true) {
            debug_output.innerText = ''
            return
        }
        debug_output.innerText = JSON.stringify(VP.current_data, null, 2)
    }

    vp_optin_toggle.innerText  = (!VP.opt_in) ? 'opt-in' : 'opt-out'

    vp_optin_toggle.addEventListener('click', () => {
        if (!VP.opt_in) {
            VP.opt_in = true
            vp_optin_toggle.innerText = 'opt-out'
            update_display()
        }
        else {
            if (!confirm('you sure? this will purge all your progress!')) return
            VP.opt_in = false
            vp_optin_toggle.innerText = 'opt-in'
            update_display(true)
        }
    }, false)

    update_display()
</script>
